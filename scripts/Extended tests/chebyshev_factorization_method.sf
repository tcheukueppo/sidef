#!/usr/bin/ruby

# A simple factorization method, using the Chebyshev T_n(x) polynomials, based on the identity:
#   T_{m n}(x) = T_m(T_n(x))

# where:
#   T_n(x) = (1/2) * V_n(2x, 1)

# where V_n(P, Q) is the Lucas V sequence.

for n in (
    4687127904923490705199145598250386612169614860009202665502614423768156352727760127429892667212102542891417456048601608730032271
    2593364104508085171532503084981517253915662037671433715309875378319680421662639847819831785007087909697206133969480076353307875655764139224094652151
    850794313761232105411847937800407457007819033797145693534409492587965757152430334305470463047097051354064302867874781454865376206137258603646386442018830837206634789761772899105582760694829533973614585552733
  ) {

    say "\n:: Factoring: #{n}";

    while (n.is_composite) {
        var f = chebyshev_factor(n, 500_000, 1e7.irand)
        if (f.len > 1) {
            var p = f.first
            say "-> Found factor: #{p}"
            n /= p
        }
    }
}
