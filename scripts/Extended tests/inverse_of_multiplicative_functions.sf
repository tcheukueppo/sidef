#!/usr/bin/ruby

# Several tests for the inverse of some multiplicative functions.

assert_eq(
    inverse_phi(2**32),
    %n[8589934592, 8590065664, 8623489024, 8623620608, 9126805504, 9126944768, 9162457088, 9162596896, 10737418240, 10737582080, 10779361280, 10779525760, 11408506880, 11408680960, 11453071360, 11453246120, 12884901888, 12885098496, 12935233536, 12935430912, 13690208256, 13690417152, 13743685632, 13743895344, 16106127360, 16106373120, 16169041920, 16169288640, 17112760320, 17113021440, 17179607040, 17179869180]
)

assert_eq(
    inverse_phi(2**64),
    %n[36893488147419103232, 36894051097372524544, 37037603335494959104, 37038168484471635968, 39199331156632797184, 39199929290958307328, 39352453543963394048, 39353054014751113216, 46116860184273879040, 46117563871715655680, 46297004169368698880, 46297710605589544960, 48999163945790996480, 48999911613697884160, 49190566929954242560, 49191317518438891520, 55340232221128654848, 55341076646058786816, 55556405003242438656, 55557252726707453952, 58798996734949195776, 58799893936437460992, 59028680315945091072, 59029581022126669824, 69175290276410818560, 69176345807573483520, 69445506254053048320, 69446565908384317440, 73498745918686494720, 73499867420546826240, 73785850394931363840, 73786976277658337280]
)

assert_eq(
    inverse_psi(2**64),
    %n[13297978429596511779, 15512295988310733913, 16138807601873739769, 16140901064495857657]
)

assert_eq(
    inverse_psi(2**128),
    %n[214641354189917290491285898642107841803, 247205755482045045599950105312064937891, 253185091141103338304706210356001349251, 255211288412873359957440780839793721347, 288407264822254805120270159652600471769, 288442474951010250157662371788275843289, 297744231522809434434092259368732327929, 337582053185158288077351219082067173249, 340279121581898825332115751913104211969]
)

assert_eq(
    inverse_sigma(2**64),
    %n[13297978429596511779, 15512295988310733913, 16138807601873739769, 16140901064495857657]
)

assert_eq(
    inverse_sigma(2**128),
    %n[214641354189917290491285898642107841803, 247205755482045045599950105312064937891, 253185091141103338304706210356001349251, 255211288412873359957440780839793721347, 288407264822254805120270159652600471769, 288442474951010250157662371788275843289, 297744231522809434434092259368732327929, 337582053185158288077351219082067173249, 340279121581898825332115751913104211969]
)

assert_eq(inverse_uphi(2**64 - 1), %n[18446744073709551616])
assert_eq(inverse_uphi(2**128 - 1), %n[340282366920938463463374607431768211456])

assert_eq(
    inverse_usigma(2**64),
    %n[13297978429596511779, 15512295988310733913, 16138807601873739769, 16140901064495857657]
)

assert_eq(
    inverse_usigma(2**128),
    %n[214641354189917290491285898642107841803, 247205755482045045599950105312064937891, 253185091141103338304706210356001349251, 255211288412873359957440780839793721347, 288407264822254805120270159652600471769, 288442474951010250157662371788275843289, 297744231522809434434092259368732327929, 337582053185158288077351219082067173249, 340279121581898825332115751913104211969]
)

assert_eq(
    inverse_usigma(871429840783832935182653499240),
    %n[522857570553738701444387970234, 561587760965126753403170978042, 580126214805717480122394725594, 580952856170820779382653300260, 580953190087381839047829244558, 658413236993596883300269422532, 694689140681196396216030816572, 697143427404984935259108800328, 697143847892506269652293322732, 726191503068327347868281224385, 774604253449842452063688814936, 842381641447690130104847285377, 861746736653384156084176155961, 870189322208576220183685904689, 870202474810897959217607507687, 870740074290564000527307859489, 870747970798869059646516836383, 871007553823252831580097581657]
)

assert_eq(
    inverse_phi(198509600273760249582271755720),
    %n[199149961705960799317620148051, 398299923411921598635240296102],
)

assert_eq(
    inverse_psi(948868251788734006594076134840),
    %n[948867999921966458350773353479],
)

assert_eq(
    inverse_uphi(193088240337138888383984334172),
    %n[193088240337138888383984334173, 386176480674277776767968668346]
)

assert_eq(
    inverse_sigma(18013626487848147771139981240),
    %n[17993787692156685053330354803, 18013576150770833044297363447]
)

say ":: Test passed!"
