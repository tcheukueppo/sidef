#!/usr/bin/ruby

# Extended tests for some pseudoprime-related functions.

assert_eq(
    13.lucas_carmichael(2*409810997884396741919),
    %n[409810997884396741919, 527999053751911334879, 752983545644288511839, 760276539527430038399, 761686421126390272799, 777695624868402683135]
)

assert_eq(
    13.squarefree_fermat_psp(2, 714068187095871314785),
    %n[606395069520916762801, 714068187095871314785]
)

assert_eq(
    13.carmichael(2224638822986085386881),
    %n[1791562810662585767521, 2085369258604105837441, 2224638822986085386881]
)

assert_eq(
    13.fermat_psp(13, 1035591157050957605345),
    %n[1035551157050957605345]
)

assert_eq(
    14.fermat_psp(14, 1035551157050957605345, 57044815596229144811105)
    %n[57044715596229144811105]
)

say "** Test passed!"
