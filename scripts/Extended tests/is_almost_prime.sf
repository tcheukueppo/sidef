#!/usr/bin/ruby

# Tests for the Number `is_almost_prime(n,k)` method.

func A242786(n) {
    for (var p = 2; true; p.next_prime!) {
        var v = (p**n + 1)
        v.is_almost_prime(n) || next
        return p
    }
}

assert_eq(
    A242786.map(1..11),
    %n[2, 3, 3, 43, 7, 41, 23, 643, 17, 557, 251],
)

#assert_eq(A242786(21), 1151)

func A241793(n) {
    for k in (1..Inf) {
        var b = bigomega(k)*n
        var v = (k**n - 1)
        is_almost_prime(v, b) || next
        return k
    }
}

assert_eq(
    A241793.map(1..16),
    %n[3, 34, 5, 15, 17, 55, 79, 5, 53, 23, 337, 13, 601, 79, 241, 41],
)

assert_eq(A241793(24), 79)

func A280005(n) {
    for(var p = 2; true; p.next_prime!) {
        var v = (p**n + 1)
        v.is_prob_squarefree(1e4) || next
        v.is_almost_prime(n) || next
        if (v.is_squarefree) {
            return p
        }
    }
}

assert_eq(
    A280005.map(1..10),
    %n[2, 3, 13, 43, 73, 47, 457, 1697, 109, 8161]
)

func A281940(n) {
    for k in (1..Inf) {
        var v = (k**n + 1)
        v.is_prob_squarefree(1e4) || next
        v.is_almost_prime(n) || next
        if (v.is_squarefree) {
            return k
        }
    }
}

assert_eq(
    A281940.map(1..12),
    %n[1, 3, 9, 43, 46, 47, 245, 1697, 109, 565, 3938, 3255]
)

assert(6378421230653912273852177516895163581869770560831402039659052275307515868158149242183187027058743269083585164524698761215608346720446543721867890772992768450030990772124462439643369906993789153742999577997533023369718005328697704646795653340413290216914429581800198907520670422145782789421503445838438309411889963011879677086315079680346076913198656865252722018507700079241053301126985375100206013999932788906892043402372100794021347723757962214999239405763985925478958053765385390392428991093620063803159748213554713516270836566432768442321417273611613661964043740485967874546203158330542419346172965725208847889307596664965692982489236584360678086793885224312622009679624680125435713130901431548084498643988804235541146098681538248403808764459574030837406569943265425119945515620987942036623366002995111745100363660322741847883390914005559246543930659653872917345326198079665168962285351976979752322993704768006328130917743545206406358713737580633683126888580933576598622705103763505867769189580877823254445988109717369710491787515696906699326587144119103036177901022625401163297714167068028230540962534246165735639040001.is_almost_prime(2))

say "** Test passed!"
