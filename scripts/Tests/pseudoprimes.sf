#!/usr/bin/ruby

# Tests for some pseudoprime-related functions

assert_eq(
    9.lucas_carmichael(61044448782239)
    %n[14563696180319, 16569718534655, 20203946790335, 22034564147519, 23315834862719, 23889526894079, 27074874805055, 28932092649215, 31534433588735, 34236981827279, 34249223161439, 45373136257295, 45593377151399, 50103079391519, 50415330959279, 50683388926247, 51367989177791, 51662281823999, 58062571206479, 61044448782239]
)

assert_eq(
    9.lucas_carmichael(23315834862719, 45593377151399)
    %n[23315834862719, 23889526894079, 27074874805055, 28932092649215, 31534433588735, 34236981827279, 34249223161439, 45373136257295, 45593377151399]
)

assert_eq(
    11.lucas_carmichael(196467189590024639),
    %n[20576473996736735, 42380075646230399, 75943207554554879, 83668951228080959, 96195222056687039, 116436396482735615, 132525862783734959, 134052021887096159, 162544912900261199, 175900784368936319, 186326804496197519, 190523141606006495, 196467189590024639]
)

assert_eq(
    11.carmichael(132819104923908481),  # https://oeis.org/A338443
    %n[60977817398996785, 105083995864811041, 107473646345582881, 132819104923908481],
)

assert_eq(
    3.carmichael(1e6, 2e6),
    %n[1024651, 1152271, 1193221, 1461241, 1615681, 1857241, 1909001],
)

assert_eq(
    4.carmichael(1e6, 2e6),
    %n[1033669, 1082809, 1569457, 1773289]
)

assert_eq(
    5.carmichael(1e6, 2e6),
    %n[1050985]
)

assert_eq(
    6.carmichael(1e6, 2e6),
    %n[]
)

assert_eq(
    7.squarefree_fermat(2, 14795826661),   # https://oeis.org/A112445
    %n[370851481, 1310486905, 1452092005, 1553860945, 2719940041, 3328293745, 3860623585, 5394826801, 5612626041, 5659475185, 6295936465, 8857509661, 9234602385, 10780911505, 10975165201, 11718888181, 12254138065, 12416553721, 12452890681, 13577445505, 14795826661]
)

assert_eq(
    7.squarefree_fermat(2, 3860623585, 10975165201),   # https://oeis.org/A112445
    %n[3860623585, 5394826801, 5612626041, 5659475185, 6295936465, 8857509661, 9234602385, 10780911505, 10975165201]
)

assert_eq(
    2.squarefree_fermat(3, 1e5),
    %n[91, 671, 703, 949, 1541, 1891, 2701, 3281, 8401, 12403, 14383, 15203, 16531, 18721, 23521, 24727, 28009, 30857, 31621, 31697, 38503, 44287, 46999, 47197, 49051, 49141, 55261, 55969, 63139, 72041, 74593, 79003, 82513, 83333, 88573, 88831, 90751, 96139, 97567]
)

assert_eq(
    2.squarefree_fermat(3, 30857, 83333),
    %n[30857, 31621, 31697, 38503, 44287, 46999, 47197, 49051, 49141, 55261, 55969, 63139, 72041, 74593, 79003, 82513, 83333]
)

say "** Test passed!"
